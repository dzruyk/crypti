#RSA library

def rsakg(const len, exp, n, d) {

	p = rand_prime(len / 2);
	q = rand_prime(len / 2);

	n = p * q;

	p -= 1
	q -= 1

	phi = p * q

	d = mod_inv(e, phi);

	return 0;
}

def rsaep(m, exp, n, cipher) {

	if (m >= n) {
		print("error\n");
		return -1;
	}

	mod_exp(chipher, m, exp, n)
	return 0;
}

def rsadp(chipher, d, n, m) {
	
	if (cipher >= n) {
		print("error\n");
		return -1;
	}

	mod_exp(m, chipher, d, n);
	return 0;
}

/*
 * Without MGF hash OS2IP I2OSP functions
 */
def rsa_oaep_ep(n, e, M, L) {
	//without error checks now
	lHash = SOME_HASH(L);
	hLen = len(lHash);

	PS = new_str(k - mLen - 2hLen - 2, 0);
	DB = lHash + PS + "\x01" + M

	seed = rand_str(hLen);
	dbMask = MGF(seed, k - hLen - 1)
	maskedDB = DB ^ dbMask
	seedMask = MGF()
}
